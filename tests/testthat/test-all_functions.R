test_that("pval_string works correctly", {
  expect_equal(pval_string(0.051), "0.051")
  expect_equal(pval_string(0.05), "0.050")
  expect_equal(pval_string(0.0001), "< 0.001")
  expect_equal(pval_string(0.048), '0.04')
  expect_equal(pval_string(0.054), '0.054')
  expect_equal(pval_string(0.059), '0.059')
  expect_equal(pval_string(0.045), '0.04')
  expect_equal(pval_string(0.4), '0.40')
  expect_equal(pval_string(0.3454149), '0.34')
  expect_equal(pval_string(0.399949), '0.39')
  expect_equal(pval_string(0.04), '0.04')
  expect_equal(pval_string(0.002), '0.002')
  expect_equal(pval_string(0.00002), '< 0.001')
})

test_that("num_string works correctly", {
  expect_equal(num_string(123.456789), "123.46")
  expect_equal(num_string(30), '30.00')
  expect_equal(num_string(0), '0.00')
  expect_equal(num_string(0.001), '0.001')
  expect_equal(num_string(0.0001), '1.00e-04')
  expect_equal(num_string(0.041212), '0.04')
  expect_equal(num_string(0.1), '0.10')
  expect_equal(num_string(45.5151), '45.52')
  expect_equal(num_string(5115156), '5.12e+06')
})
